public String forgetPassword() {
        User user = loginService.findUserByUsername(getUsernameForget());
//        if (user != null && user.getCodeRamz() != null && user.getCodeRamz().length() > 0 && user.getCodeRamzTarikh().equals(DateUtil.getCurrentDate())){
//            addActionError("کد رمز برای شما ارسال شده است.");
//            return ERROR;
//        }

        if (user != null && user.getMobile() != null && user.getMobile().equals(getMobileForget())) {

            Random ran = new Random();
            int x = ran.nextInt(9999);
            String code = "parsian" + x;
            String ramzStr = "";
            if (OmrUtil.userHasRole(user, "ROLE_USER_KARTABL")) {
                user.setPassword(StringUtil.md5Hash(code));
                user.setValidPass(false);
                ramzStr = "کلمه عبور";
                userKrtbl = true;
            } else {
                user.setCodeRamz(code);
                user.setCodeRamzTarikh(DateUtil.getCurrentDate());
                ramzStr = "کد رمز کاربر ";
                userKrtbl = false;
            }
            loginService.updateUser(user);
            try {
                String firstName = (user.getFirstName() != null ? user.getFirstName() : "-");
                String lastName = (user.getLastName() != null ? user.getLastName() : "-");
                String cellPhoneNo = user.getMobile();
                String description = "بازیابی کلمه عبور";
                String issueDate = DateUtil.getCurrentDate();
                String text = ramzStr + user.getUsername() + " در بیمه پارسیان برابر " + code + " می باشد.";
                String policyId = user.getUsername();
                boolean b = SMSSender.sendSMS(firstName, lastName, cellPhoneNo, text, description, policyId, 8, "", "", "");
                String currentTime = DateUtil.getCurrentTime();
                String currentDate = DateUtil.getCurrentDate();
                logService.addLogSMS(firstName, lastName, cellPhoneNo, text, description, policyId, 8, "", "", "", SMSSender.SmsType.PASSWORD_RECOVERY, b ,currentTime,currentDate);

                System.out.println(b + "///sms sent.............");
            } catch (Exception e) {
                e.printStackTrace();
            }
            return SUCCESS;
        }
        addActionError("نام کاربری یا شماره موبایل صحیح نمی باشد.");
        return ERROR;
    }